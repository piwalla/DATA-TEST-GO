flowchart TD
  S["홈페이지 접속<br>(/ 또는 /bookmarks)"] --> F1["로그인 상태 체크<br>(Clerk, Supabase)"]
  
  F1 -- "로그인 O" --> MainFlow
  F1 -- "로그인 X" --> G1["로그인 유도<br>(Clerk Auth) /<br>북마크 임시 저장 (localStorage)"]

  subgraph MainFlow["메인 서비스 흐름"]
    direction TB
    A1["관광지 목록 조회<br>(지역/타입/키워드 필터)"] --> A2["관광지 카드 클릭<br>→ 상세페이지 이동"]
    A2 --> A3["상세정보/운영정보/이미지/지도 표시"]
    A3 --> A4["북마크 버튼 클릭<br>(즐겨찾기 추가/삭제, Supabase 저장)"]
    A2 -- "공유" --> A5["URL 복사/OG Meta/<br>공유 버튼"]
    A1 -- "정렬·필터 변경" --> A1
    A1 -- "지도 보기" --> A6["지도에서 마커 표시<br>(관광지 위치 확인)"]
    A1 -- "검색(키워드)" --> A1
    A4 -- "북마크 추가/제거 성공" --> A7["토스트 메시지/상태 업데이트"]
    A4 -- "로그인X" --> G1
    A6 -- "카드/마커 상호작용" --> A2
    A5 -- "복사 성공" --> A7
    A1 -- "북마크 목록 확인" --> B1["/bookmarks 내 북마크 목록"]
    B1 -- "정렬·일괄삭제" --> B1
    B1 -- "목록 카드 클릭" --> A2
  end

  G1 -- "로그인하면 세션 연결 및 북마크 싱크" --> MainFlow